# MicroBo（AltSuperBlade's Part）

## 个人在本次大作业中的主要贡献

- 作为小组组长组织完成了 MicroBo 的开发
- 基本独立地完成了网站的开发，具体包括：

  - 进行了需求分析，确定了要制作的页面
  - 完成了所有页面的后端开发
  - 对每个页面进行了基本的前端设计
  - 确定了将 Flask 框架中的 SSTI 漏洞作为漏洞点并完成了漏洞的实现
  - 搭建了对应的数据库

## 完成了哪些自认为有技术含量的工作

- 利用正则表达式实现了对邮箱可靠性和密码安全性的验证
- 使用 `flask_wtf` 和 `wtforms` 包实现了在同一个页面中提交不同的表单
- 使用白名单和魔术头检查技术实现了上传图片功能
- 使用散列函数的方式实现了上传头像中的秒传功能
- 实现了 SSTI 漏洞在网站中的部署

## 印象深刻的一些 bug 和自己的解决方法

1. 在制作 `profile` 页面的过程中，从 `home` 页面跳转时，无法将访问者和被访问者信息同时传入后端以获取正确的页面。

   解决方法：

   - 改变需要访问的 url，使用 flask 能够从路由传参的功能，通过将被访问者的 id 添加到 url 中从而传递了参数。

2. 在制作 `edit` 页面的过程中，无法将修改 `nickname` 和 `email` 的表单分开提交。

   解决方法：

   - 使用 `flask_wtf` 中的 `FlaskForm` 模块和 `wtforms` 包中的功能，编写了提交对应表单的类。
   - 在路由中调用实例，并使用如下两个判断语句来判断此表单是否被提交，从而解决了分别提交两个表单的问题。

     ```python
     if [ 表单实例 ].[ 提交域 ].data and [ 表单实例 ].validate():
     # if edit_email.submit1.data and edit_email.validate():
     ```

3. 按上述操作进行后，无法正确提交表单。

   解决方法：

   - 在提交页面的 html 模板中，须在 `form` 中添加：

     ```html
     {{ [ 实例名 ].csrf_token }}
     ```

4. 无法实现点击按钮时跳转页面。

   解决方法：

   - 考虑如下几种选择：

     ```html
     方案一：
     <button
       type="submit"
       onclick="window.location.href='{{ url_for('[ 蓝图名称 ].[ 路由名称 ]') }}'"
     >
       Some word
     </button>
     ```

     ```python
     方案二：
     #直接在路由中实现：接收到post请求则
     return redirect(url_for('[ 蓝图名称 ].[ 路由名称 ]'))
     ```
