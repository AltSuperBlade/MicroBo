# MicroBo（Tbc-tang's Part）

## 个人在本次大作业中的主要贡献

- 作为小组成员参与完成了 MicroBo 的开发

- 全权负责完成Break_it环节，具体包括：
  
  - 与负责前端的同学对接，确认环境可靠性
  - 以黑盒测试状态分步攻击网站，找到并利用 SSTI 漏洞构建恶意命令，最终找到隐藏的 flag 文件，并完成相关文档编写
  - 完成exp验证代码的编写与测试

- 录制、剪辑测试视频

- 与各位同学对接并编写最终成品的根目录下的 README.md

## 完成了哪些自认为有技术含量的工作

- 实际上，我的主要工作可以总结为 ctf 训练后的成果检验：
  - 用 `nmap` 扫描全端口，确定攻击端口
  - 用 `ksubdomain` 工具爆破网站子域名，确定没有隐藏子域名
  - 用 `dirb` 工具检测隐藏目录，并在因网站配置错误而产生的 `index` 页面下找到 SSTI 漏洞线索
  - 用 SSTI 漏洞构建相关恶意命令，在隐藏文件中找到 flag

## 印象深刻的一些 bug 和自己的解决方法

1. `ksubdomain` 工具的 `-b` 参数宣称是宽带的下行速度，数值越大发包越快，但实际上严重依赖于你当前的网络状况，如果你恰巧在利用网络进行别的任务，发包速度会慢到令人发指；同时，当你填写了较大的数值时，该工具会占用过多内存，并且在事实上降低了爆破效率
- 解决方法
  
  - 多次测试后，我个人认为将参数取为 `-b 10m` 时效率较高
2. 构建 exp.py 文件时，该文件在运行时无法打开拼接了恶意命令的 url ，导致验证失败
- 解决方法
  - 将构建的恶意命令先进行 URL 编码，再拼接至要攻击的地址后

> **印象深刻但算不上 bug 的部分内容**

3. 我们小组曾经选择租赁了阿里的服务器来在线更新我们的网站，事实上，如果您在 8 月 20 日之前看到了这部分内容，都可以登录 `http://39.107.246.62:11451/login?next=%2F` 来访问我们构建的早期网站（这个版本里我们甚至还没有塞进 flag ）。
   
   虽然在线开发网站有诸多好处，比如大量的检测工具（类似[ OneForAll ](https://github.com/shmilylty/OneForAll)）只能检查在互联网上的网站，而检测本地环境会遇到各种各样的、类似检测不到有效域名的问题，可以大大增加工具备选项，但我们还是选择放弃了在线版本的构建。
   
   原因是阿里的服务器自带有一套安全检测与防护系统，过于明显的漏洞会被检测出来，同时服务器会拒绝你上线有漏洞的版本；同时，诸如 `nmap` 扫描之类的操作也会被服务器感知到，并且统统给你防出去，耗时良久不说（ kali 虚拟机实测在一个半小时左右），最后也找不到有用的端口，这些都对我们的漏洞部署与攻破提出了太多的要求，并最终导致我们选择放弃线上版本的构建。
